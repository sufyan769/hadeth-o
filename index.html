<!DOCTYPE html>
<html lang="ar">
<head>
<meta charset="UTF-8" />
<title>البحث في الأحاديث</title>

<script src="https://cdn.jsdelivr.net/npm/algoliasearch@4/dist/algoliasearch-lite.umd.js"></script>

<style>
 body { font-family: Arial, sans-serif; direction: rtl; background:#fafafa; padding:30px; }
 input { width:100%; padding:15px; font-size:20px; border-radius:6px; border:1px solid #ccc; }
 .result { background:white; padding:15px; margin-top:10px; border-radius:6px; }
</style>
</head>
<body>

<input id="searchBox" placeholder="ابحث هنا...">

<div id="results"></div>
<div id="debug" style="margin-top:20px; color:red;"></div>

<script>
const APP_ID     = "3XD12I7386";
const SEARCH_KEY = "89e8e132a05fdb02275f64dec8d14d05";   // فقط للبحث (آمن)
const INDEX_NAME = "hadeth-2";

// ✅ اتصال Algolia
const client = algoliasearch(APP_ID, SEARCH_KEY);
const index  = client.initIndex(INDEX_NAME);

// ✅ عند الكتابة في البحث
document.getElementById("searchBox").addEventListener("input", async (e) => {
    const q = e.target.value.trim();
    let resultsDiv = document.getElementById("results");
    let debug = document.getElementById("debug");

    resultsDiv.innerHTML = "";
    debug.innerHTML = "";

    if (q === "") return;

    try {
        const res = await index.search(q);

        if (res.hits.length === 0) {
            resultsDiv.innerHTML = "<p>لا توجد نتائج</p>";
            return;
        }

        res.hits.forEach(h => {
            resultsDiv.innerHTML += `
                <div class="result">
                    ${h.text}
                </div>
            `;
        });

    } catch (err) {
        debug.innerHTML = "❌ خطأ: " + err;
        console.error(err);
    }
});
</script>

</body>
</html>
