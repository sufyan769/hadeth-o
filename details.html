<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8">
<meta name="description" id="metaDesc" content="تفاصيل الحديث">
<title>تفاصيل الحديث</title>

<style>
body { font-family: sans-serif; background:#f5f5f5; margin:0; padding:25px; line-height:2 }
.container { max-width:900px; margin:auto; background:white; padding:25px; border-radius:10px; }
.label { font-weight:bold; margin-top:15px; display:block; }
.value { border-bottom:1px solid #eee; padding-bottom:10px; margin-bottom:10px; }
.tag { background:#007bff; color:white; padding:4px 8px; border-radius:5px; text-decoration:none; margin:2px; display:inline-block; }
</style>
</head>
<body>
<div class="container">

  <h2 id="title">الحديث</h2>

  <div class="label">الحديث:</div><div id="text" class="value"></div>
  <div class="label">الشرح:</div><div id="sharh" class="value"></div>
  <div class="label">الراوي:</div><div id="rawi" class="value"></div>
  <div class="label">المحدث:</div><div id="muhaddith" class="value"></div>
  <div class="label">المصدر:</div><div id="source" class="value"></div>
  <div class="label">التخريج:</div><div id="takhrij" class="value"></div>
  <div class="label">الحكم:</div><div id="hukm" class="value"></div>
  <div class="label">التصنيف:</div><div id="categories" class="value"></div>

  <a href="/hadeth-o/search.html" class="tag">🔍 رجوع للبحث</a>

</div>

<script>
// ✅ قراءة id سواء من /hadith/ID/ أو من ?id=
let id = new URLSearchParams(location.search).get("id");
if (!id) {
  const m = location.pathname.match(/\/hadith\/(\d+)\/?/);
  id = m ? m[1] : null;
}

const API = `https://g85b062bd5c6cb1-fatwaproject.adb.me-dubai-1.oraclecloudapps.com/ords/SUFEAN/hadeeth/search_by_id/${id}`;

fetch(API).then(r => r.json()).then(data => {
  const h = data.items?.[0];
  if (!h) { document.getElementById("text").innerText = "الحديث غير موجود"; return; }

  document.getElementById("text").innerText = h.text || "—";
  document.getElementById("sharh").innerText = h.sharh || "—";
  document.getElementById("rawi").innerText = h.rawi || "—";
  document.getElementById("muhaddith").innerText = h.muhaddith || "—";
  document.getElementById("source").innerText = h.source || "—";
  document.getElementById("hukm").innerText = h.hukm || "—";
  document.getElementById("takhrij").innerText = h.takhrij || "—";

  // ✅ التصنيفات → تصبح روابط SEO /category/
  if (h.categories) {
      document.getElementById("categories").innerHTML =
      h.categories.split(",").map(c =>
        `<a class="tag" href="/hadeth-o/category/${encodeURIComponent(c.trim())}/">${c.trim()}</a>`
      ).join("");
  }

  // ✅ تحسين SEO
  document.title = h.text.slice(0, 70);
  document.getElementById("metaDesc").content = h.sharh || h.text;

  // ✅ Schema.org
  const schema = {
    "@context": "https://schema.org",
    "@type": "Article",
    "headline": h.text.slice(0, 110),
    "articleBody": h.sharh || h.text,
    "author": h.rawi || "",
    "inLanguage": "ar"
  };
  let s = document.createElement("script");
  s.type = "application/ld+json";
  s.textContent = JSON.stringify(schema);
  document.head.appendChild(s);
});
</script>
</body>
</html>
