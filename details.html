<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>تفاصيل الحديث</title>
<style>
    body { font-family: sans-serif; background:#f6f6f6; padding:30px; }
    .container { max-width:850px; margin:auto; background:white; padding:30px; border-radius:12px; }
    h1 { text-align:center; margin-bottom:25px; }
    .label { font-weight:bold; margin-top:15px; }
    .value { margin-bottom:20px; }
    .category-badge {
        background:#0d6efd; color:white;
        padding:5px 10px; border-radius:6px;
        margin:3px; display:inline-block;
        text-decoration:none;
    }
    .btn-back {
        margin-top: 30px; display: inline-block;
        background:#0d6efd; color:white;
        padding:10px 18px; border-radius:10px;
        text-decoration:none; font-size:17px;
    }
</style>
</head>
<body>

<div class="container">
    <h1>تفاصيل الحديث</h1>

    <div class="label">الحديث:</div>
    <div class="value" id="text">جاري التحميل...</div>

    <div class="label">الشرح:</div>
    <div class="value" id="sharh">—</div>

    <div class="label">الراوي:</div>
    <div class="value" id="rawi">—</div>

    <div class="label">المحدث:</div>
    <div class="value" id="muhaddith">—</div>

    <div class="label">المصدر:</div>
    <div class="value" id="source">—</div>

    <div class="label">الصفحة أو الرقم:</div>
    <div class="value" id="page_number">—</div>

    <div class="label">الحكم:</div>
    <div class="value" id="hukm">—</div>

    <div class="label">التخريج:</div>
    <div class="value" id="takhrij">—</div>

    <div class="label">التصنيف:</div>
    <div class="value" id="categories">—</div>

    <a href="index.html" class="btn-back">🔍 رجوع للبحث</a>
</div>


<script>
// ✅ استخراج id من الرابط
const params = new URLSearchParams(window.location.search);
const id = params.get("id");

// ✅ API رابط Oracle
const apiUrl = `https://g85b062bd5c6cb1-fatwaproject.adb.me-dubai-1.oraclecloudapps.com/ords/SUFEAN/hadeeth/search_by_id/${id}`;


// ✅ تحويل التصنيفات إلى روابط مستقلة
function renderCategories(categoryText) {
    if (!categoryText || categoryText.trim() === "") return "—";

    const parts = categoryText
        .split(/[,|]/)
        .map(c => c.trim())
        .filter(c => c.length > 0);

    return parts
        .map(cat => `
            <a class="category-badge"
                href="https://g85b062bd5c6cb1-fatwaproject.adb.me-dubai-1.oraclecloudapps.com/ords/SUFEAN/hadeeth/search_category/${encodeURIComponent(cat)}"
                target="_blank">
                ${cat}
            </a>
        `)
        .join("");
}


// ✅ جلب بيانات الحديث من Oracle
fetch(apiUrl)
  .then(res => res.json())
  .then(data => {
      if (!data.items || data.items.length === 0) {
          document.getElementById("text").innerText = "لم يتم العثور على الحديث.";
          return;
      }

      const h = data.items[0];

      document.getElementById("text").innerText = h.text || "—";
      document.getElementById("sharh").innerText = h.sharh || "—";
      document.getElementById("rawi").innerText = h.rawi || "—";
      document.getElementById("muhaddith").innerText = h.muhaddith || "—";
      document.getElementById("source").innerText = h.source || "—";
      document.getElementById("page_number").innerText = h.page_number || "—";
      document.getElementById("hukm").innerText = h.hukm || "—";
      document.getElementById("takhrij").innerText = h.takhrij || "—";

      // ✅ التصنيفات (الروابط الذكية)
      document.getElementById("categories").innerHTML = renderCategories(h.categories);
  })
  .catch(err => {
      document.getElementById("text").innerText = "حدث خطأ أثناء تحميل البيانات.";
      console.error(err);
  });
</script>

</body>
</html>
